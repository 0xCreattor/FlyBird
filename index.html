<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Flying Bird - Soundness vApp</title>
  <style>
    body { margin: 0; overflow: hidden; background: linear-gradient(to bottom, #87CEEB, #fff); font-family: sans-serif; }
    canvas { display: block; margin: auto; background: #70c5ce; }
    #score { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); font-size: 24px; font-weight: bold; }
  </style>
</head>
<body>
  <div id="score">Score: 0</div>
  <canvas id="gameCanvas" width="400" height="600"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    let frames = 0, score = 0;
    const DEGREE = Math.PI / 180;

    // bird
    const bird = {
      x: 50, y: 150, w: 30, h: 30, gravity: 0.25, jump: 4.6, speed: 0, rotation: 0,
      draw() {
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.rotate(this.rotation);
        ctx.fillStyle = "yellow";
        ctx.fillRect(-this.w/2, -this.h/2, this.w, this.h);
        ctx.restore();
      },
      update() {
        this.speed += this.gravity;
        this.y += this.speed;
        if(this.y + this.h/2 >= canvas.height) this.y = canvas.height - this.h/2;
        if(this.y - this.h/2 <= 0) this.y = this.h/2;
        this.rotation = this.speed >= this.jump ? 90 * DEGREE : -25 * DEGREE;
      },
      flap() { this.speed = -this.jump; }
    };

    // pipes
    const pipes = {
      position: [],
      w: 50, h: 400, gap: 120, dx: 2,
      draw() {
        ctx.fillStyle = "#228B22";
        this.position.forEach(p => {
          let topY = p.y;
          let bottomY = p.y + this.h + this.gap;
          ctx.fillRect(p.x, topY, this.w, this.h);
          ctx.fillRect(p.x, bottomY, this.w, this.h);
        });
      },
      update() {
        if(frames % 100 === 0){
          let y = -this.h + Math.random() * (this.h/2);
          this.position.push({x: canvas.width, y});
        }
        this.position.forEach((p, i) => {
          p.x -= this.dx;
          if(p.x + this.w <= 0){ this.position.splice(i,1); score++; document.getElementById("score").innerText = "Score: " + score; }
        });
      }
    };

    function loop(){
      frames++;
      ctx.fillStyle = "#70c5ce";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      pipes.update(); pipes.draw();
      bird.update(); bird.draw();

      requestAnimationFrame(loop);
    }

    document.addEventListener("keydown", e => { if(e.code === "Space") bird.flap(); });
    document.addEventListener("click", () => bird.flap());

    loop();
  </script>
</body>
</html>
